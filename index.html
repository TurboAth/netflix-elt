<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Netflix ELT Pipeline Project</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <aside class="sidebar">
        <header>
            <h1>Netflix ELT</h1>
            <p>Project Docs</p>
        </header>
        <nav class="nav-menu">
            <a href="#overview" class="nav-link active">Overview</a>
            <a href="#setup" class="nav-link">Setup Guide</a>
            <a href="#pipeline" class="nav-link">Pipeline Code</a>
            <a href="#scripts" class="nav-link">Helper Scripts</a>
            <a href="#license" class="nav-link">License</a>
        </nav>
        <footer>
            <p>¬© 2025 TurboAth</p>
        </footer>
    </aside>

    <main class="content">

        <section id="overview" class="card">
            <h2>üß± Project Overview</h2>
            <p>A clean, reproducible ELT pipeline that:</p>
            <ul>
                <li><strong>Extracts</strong> the public <em>Netflix Movies and TV Shows</em> dataset from Kaggle</li>
                <li><strong>Loads</strong> it into PostgreSQL with idempotent, fast inserts</li>
                <li><strong>Transforms</strong> into a clean table for analysis</li>
                <li><strong>Runs</strong> on a daily schedule with Airflow</li>
                <li><strong>Ships</strong> with logs, scripts and a GitHub‚Äëready structure</li>
            </ul>

            <h3>Project Structure</h3>
            <div class="code-block-wrapper">
                <button class="copy-button" title="Copy to clipboard">
                    <span class="copy-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                          <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                          <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
                        </svg>
                    </span>
                    <span class="copied-icon" style="display:none;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                          <path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.854 13.03a.75.75 0 0 1-1.06 0L3.22 8.394a.75.75 0 1 1 1.06-1.06l3.3 3.438 4.95-5.797a.733.733 0 0 1 1.05-.01z"/>
                        </svg>
                    </span>
                </button>
                <pre><code>airflow/
 ‚îú‚îÄ‚îÄ dags/
 ‚îÇ   ‚îî‚îÄ‚îÄ netflix_pipeline_dag.py
 ‚îú‚îÄ‚îÄ data/
 ‚îÇ   ‚îî‚îÄ‚îÄ netflix_titles.csv
 ‚îú‚îÄ‚îÄ scripts/
 ‚îÇ   ‚îú‚îÄ‚îÄ setup_airflow.sh
 ‚îÇ   ‚îî‚îÄ‚îÄ env.example
 ‚îú‚îÄ‚îÄ requirements.txt
 ‚îî‚îÄ‚îÄ README.md</code></pre>
            </div>
            <p><em>You can place this folder anywhere (e.g., <code>~/airflow_home</code>). Make sure your Airflow <code>dags_folder</code> points to <code>./dags</code> or add this path to Airflow config.</em></p>
        </section>

        <section id="setup" class="card">
            <h2>‚öôÔ∏è Step-by-Step Setup Guide</h2>

            <h3>Step 1: Environment Setup (Local)</h3>
            <div class="code-block-wrapper">
                <button class="copy-button" title="Copy to clipboard">
                    <span class="copy-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/></svg></span>
                    <span class="copied-icon" style="display:none;"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.854 13.03a.75.75 0 0 1-1.06 0L3.22 8.394a.75.75 0 1 1 1.06-1.06l3.3 3.438 4.95-5.797a.733.733 0 0 1 1.05-.01z"/></svg></span>
                </button>
                <pre><code class="language-bash">python3 -m venv .venv
source .venv/bin/activate
pip install --upgrade pip</code></pre>
            </div>
            <img src="https://github.com/TurboAth/netflix-elt/blob/main/assets/1.png?raw=true" alt="Terminal screenshot of venv setup">
            
            <div class="code-block-wrapper">
                <button class="copy-button" title="Copy to clipboard">
                    <span class="copy-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/></svg></span>
                    <span class="copied-icon" style="display:none;"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.854 13.03a.75.75 0 0 1-1.06 0L3.22 8.394a.75.75 0 1 1 1.06-1.06l3.3 3.438 4.95-5.797a.733.733 0 0 1 1.05-.01z"/></svg></span>
                </button>
                <pre><code class="language-bash"># Airflow requires constraints
AIRFLOW_VERSION=2.9.3
PYTHON_VERSION=$(python -c 'import sys; print(".".join(map(str, sys.version_info[:2])))')
pip install "apache-airflow==${AIRFLOW_VERSION}" \
  --constraint "https://raw.githubusercontent.com/apache/airflow/constraints-${AIRFLOW_VERSION}/constraints-${PYTHON_VERSION}.txt"

# Providers
pip install apache-airflow-providers-postgres pandas kaggle psycopg2-binary python-dotenv</code></pre>
            </div>
            <img src="https://github.com/TurboAth/netflix-elt/blob/main/assets/2.png?raw=true" alt="Terminal screenshot of airflow install">

            <h3>Option B ‚Äî Docker for PostgreSQL only</h3>
            <div class="code-block-wrapper">
                <button class="copy-button" title="Copy to clipboard">
                    <span class="copy-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/></svg></span>
                    <span class="copied-icon" style="display:none;"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.854 13.03a.75.75 0 0 1-1.06 0L3.22 8.394a.75.75 0 1 1 1.06-1.06l3.3 3.438 4.95-5.797a.733.733 0 0 1 1.05-.01z"/></svg></span>
                </button>
                <pre><code class="language-bash">docker run -d --name pg-netflix -e POSTGRES_PASSWORD=postgres \
  -e POSTGRES_DB=airflow_db -p 5432:5432 postgres:16</code></pre>
            </div>

            <h3>üîë Step 2: Kaggle API</h3>
            <ol>
                <li>On Kaggle: <strong>Account ‚Üí Create New API Token</strong></li>
                <li>Place it at <code>~/.kaggle/kaggle.json</code></li>
                <li>Restrict permissions:</li>
            </ol>
            <div class="code-block-wrapper">
                <button class="copy-button" title="Copy to clipboard">
                    <span class="copy-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/></svg></span>
                    <span class="copied-icon" style="display:none;"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.854 13.03a.75.75 0 0 1-1.06 0L3.22 8.394a.75.75 0 1 1 1.06-1.06l3.3 3.438 4.95-5.797a.733.733 0 0 1 1.05-.01z"/></svg></span>
                </button>
                <pre><code class="language-bash">chmod 600 ~/.kaggle/kaggle.json</code></pre>
            </div>
            <img src="https://github.com/TurboAth/netflix-elt/blob/main/assets/3.png?raw=true" alt="Terminal screenshot of Kaggle API setup">

            <h3>üóÑÔ∏è Step 3: PostgreSQL Connection in Airflow</h3>
            <p>Create an Airflow connection named <strong><code>pg_netflix</code></strong>.</p>
            <p><strong>CLI alternative:</strong></p>
            <div class="code-block-wrapper">
                <button class="copy-button" title="Copy to clipboard">
                    <span class="copy-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/></svg></span>
                    <span class="copied-icon" style="display:none;"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.854 13.03a.75.75 0 0 1-1.06 0L3.22 8.394a.75.75 0 1 1 1.06-1.06l3.3 3.438 4.95-5.797a.733.733 0 0 1 1.05-.01z"/></svg></span>
                </button>
                <pre><code class="language-bash">airflow connections add pg_netflix \
  --conn-uri 'postgresql+psycopg2://postgres:postgres@localhost:5432/airflow_db'</code></pre>
            </div>
            <img src="https://github.com/TurboAth/netflix-elt/blob/main/assets/4.png?raw=true" alt="Terminal screenshot of Airflow connection add">

            <h3>ü™Ñ Step 4: Initialize Airflow and User</h3>
            <div class="code-block-wrapper">
                <button class="copy-button" title="Copy to clipboard">
                    <span class="copy-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/></svg></span>
                    <span class="copied-icon" style="display:none;"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.854 13.03a.75.75 0 0 1-1.06 0L3.22 8.394a.75.75 0 1 1 1.06-1.06l3.3 3.438 4.95-5.797a.733.733 0 0 1 1.05-.01z"/></svg></span>
                </button>
                <pre><code class="language-bash">export AIRFLOW_HOME=$(pwd)
airflow db init
airflow users create --username admin --password admin \
  --role Admin --email turboath@example.com</code></pre>
            </div>
            <img src="https://github.com/TurboAth/netflix-elt/blob/main/assets/5.png?raw=true" alt="Terminal screenshot of airflow db init">
            <img src="https://github.com/TurboAth/netflix-elt/blob/main/assets/6.png?raw=true" alt="Terminal screenshot of airflow users create">

            <h3>üß† Step 5: Enable and Run the Pipeline</h3>
            <p>Start the services (two terminals):</p>
            <div class="code-block-wrapper">
                <button class="copy-button" title="Copy to clipboard">
                    <span class="copy-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/></svg></span>
                    <span class="copied-icon" style="display:none;"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.854 13.03a.75.75 0 0 1-1.06 0L3.22 8.394a.75.75 0 1 1 1.06-1.06l3.3 3.438 4.95-5.797a.733.733 0 0 1 1.05-.01z"/></svg></span>
                </button>
                <pre><code class="language-bash"># Terminal 1
airflow webserver -p 8080</code></pre>
            </div>
            <img src="https://github.com/TurboAth/netflix-elt/blob/main/assets/7.png?raw=true" alt="Terminal screenshot of airflow webserver">
            <div class="code-block-wrapper">
                <button class="copy-button" title="Copy to clipboard">
                    <span class="copy-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/></svg></span>
                    <span class="copied-icon" style="display:none;"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.854 13.03a.75.75 0 0 1-1.06 0L3.22 8.394a.75.75 0 1 1 1.06-1.06l3.3 3.438 4.95-5.797a.733.733 0 0 1 1.05-.01z"/></svg></span>
                </button>
                <pre><code class="language-bash"># Terminal 2
airflow scheduler</code></pre>
            </div>
            <img src="https://github.com/TurboAth/netflix-elt/blob/main/assets/8.png?raw=true" alt="Terminal screenshot of airflow scheduler">
            <p>Open: <a href="http://localhost:8080">http://localhost:8080</a></p>
            <img src="https://github.com/TurboAth/netflix-elt/blob/main/assets/9.png?raw=true" alt="Airflow login screen">
            <img src="https://github.com/TurboAth/netflix-elt/blob/main/assets/10.png?raw=true" alt="Airflow DAGs list">
            

            <h3>üß™ Step 6: Validate Data</h3>
            <div class="code-block-wrapper">
                <button class="copy-button" title="Copy to clipboard">
                    <span class="copy-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/></svg></span>
                    <span class="copied-icon" style="display:none;"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.854 13.03a.75.75 0 0 1-1.06 0L3.22 8.394a.75.75 0 1 1 1.06-1.06l3.3 3.438 4.95-5.797a.733.733 0 0 1 1.05-.01z"/></svg></span>
                </button>
                <pre><code class="language-sql">SELECT COUNT(*) FROM netflix;
SELECT COUNT(*) FROM netflix_clean;

SELECT country, COUNT(*) AS c
FROM netflix_clean
GROUP BY country
ORDER BY c DESC
LIMIT 10;</code></pre>
            </div>
        </section>

        <section id="pipeline" class="card">
            <h2>üì¶ Pipeline Code & Dependencies</h2>
            
            <div class="tab-container">
                <div class="tab-buttons">
                    <button class="tab-button active" data-tab="dag">dags/netflix_pipeline_dag.py</button>
                    <button class="tab-button" data-tab="reqs">requirements.txt</button>
                </div>
                
                <div class="tab-content active" data-tab="dag">
                    <div class="code-block-wrapper">
                        <button class="copy-button" title="Copy to clipboard">
                            <span class="copy-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/></svg></span>
                            <span class="copied-icon" style="display:none;"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.854 13.03a.75.75 0 0 1-1.06 0L3.22 8.394a.75.75 0 1 1 1.06-1.06l3.3 3.438 4.95-5.797a.733.733 0 0 1 1.05-.01z"/></svg></span>
                        </button>
                        <pre><code class="language-python">from __future__ import annotations
import os
import io
import logging
from datetime import datetime, timedelta
import pandas as pd
from airflow.decorators import dag, task
from airflow.exceptions import AirflowFailException
from airflow.providers.postgres.hooks.postgres import PostgresHook

# ---------- Config ----------
DATA_DIR = os.getenv("DATA_DIR", "/tmp/netflix_data")
KAGGLE_DATASET = "shivamb/netflix-shows"
RAW_CSV = os.path.join(DATA_DIR, "netflix_titles.csv")
PG_CONN_ID = os.getenv("PG_CONN_ID", "pg_netflix")

@dag(
    dag_id="netflix_elt_pipeline",
    default_args={"owner": "atharv", "retries": 1},
    start_date=datetime(2025, 11, 7),
    schedule_interval="@daily",
    catchup=False,
)
def netflix_elt_pipeline():
    log = logging.getLogger("airflow")

    @task
    def extract() -> str:
        # ... (full extract logic) ...
        log.info("Extract success.")
        return RAW_CSV

    @task
    def load(csv_path: str) -> int:
        # ... (full load logic) ...
        log.info("Load completed (upserted).")
        return len(df)

    @task
    def transform() -> int:
        # ... (full transform logic) ...
        logging.getLogger("airflow").info("Transform produced %d rows.", cnt)
        return int(cnt)

    # Orchestration
    csv_path = extract()
    _ = load(csv_path)
    _ = transform()

dag = netflix_elt_pipeline()</code></pre>
                    </div>
                </div>
                <div class="tab-content" data-tab="reqs">
                    <div class="code-block-wrapper">
                        <button class="copy-button" title="Copy to clipboard">
                            <span class="copy-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/></svg></span>
                            <span class="copied-icon" style="display:none;"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.854 13.03a.75.75 0 0 1-1.06 0L3.22 8.394a.75.75 0 1 1 1.06-1.06l3.3 3.438 4.95-5.797a.733.733 0 0 1 1.05-.01z"/></svg></span>
                        </button>
                        <pre><code>apache-airflow
apache-airflow-providers-postgres
pandas
psycopg2-binary
kaggle
python-dotenv</code></pre>
                    </div>
                </div>
            </div>
        </section>

        <section id="scripts" class="card">
            <h2>üß∞ Helper Scripts</h2>
            <div class="tab-container">
                <div class="tab-buttons">
                    <button class="tab-button active" data-tab="setup-sh">scripts/setup_airflow.sh</button>
                    <button class="tab-button" data-tab="env">scripts/env.example</button>
                </div>
                <div class="tab-content active" data-tab="setup-sh">
                    <div class="code-block-wrapper">
                        <button class="copy-button" title="Copy to clipboard">
                            <span class="copy-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/></svg></span>
                            <span class="copied-icon" style="display:none;"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.854 13.03a.75.75 0 0 1-1.06 0L3.22 8.394a.75.75 0 1 1 1.06-1.06l3.3 3.438 4.95-5.797a.733.733 0 0 1 1.05-.01z"/></svg></span>
                        </button>
                        <pre><code class="language-bash">#!/usr/bin/env bash
set -euo pipefail

AIRFLOW_VERSION="${AIRFLOW_VERSION:-2.9.3}"
PYVER="$(python -c 'import sys; ...')"

echo "[*] Upgrading pip..."
python -m pip install --upgrade pip

echo "[*] Installing Airflow..."
# ... (rest of install) ...

echo "[*] Initializing Airflow DB..."
export AIRFLOW_HOME="${AIRFLOW_HOME:-$(pwd)}"
airflow db init

echo "[*] Creating admin user..."
airflow users create \
  --username admin --password admin \
  --role Admin --email admin@example.com

echo "[*] Creating Postgres connection 'pg_netflix'..."
airflow connections add pg_netflix \
  --conn-uri 'postgresql+psycopg2://postgres:postgres@localhost:5432/airflow_db'

echo "[*] Done."</code></pre>
                    </div>
                </div>
                <div class="tab-content" data-tab="env">
                    <div class="code-block-wrapper">
                        <button class="copy-button" title="Copy to clipboard">
                            <span class="copy-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/></svg></span>
                            <span class="copied-icon" style="display:none;"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.854 13.03a.75.75 0 0 1-1.06 0L3.22 8.394a.75.75 0 1 1 1.06-1.06l3.3 3.438 4.95-5.797a.733.733 0 0 1 1.05-.01z"/></svg></span>
                        </button>
                        <pre><code class="language-bash"># Copy to .env and edit values as needed
PG_HOST=localhost
PG_PORT=5432
PG_DB=airflow_db
PG_USER=postgres
PG_PASSWORD=postgres

DATA_DIR=/tmp/netflix_data</code></pre>
                    </div>
                </div>
            </div>
        </section>

        <section id="license" class="card">
            <h2>üßæ License</h2>
            <p>Released under the <a href="httpsm://opensource.org/licenses/MIT">MIT License</a> ¬© 2025 TurboAth.</p>
            <div class="code-block-wrapper">
                <button class="copy-button" title="Copy to clipboard">
                    <span class="copy-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/></svg></span>
                    <span class="copied-icon" style="display:none;"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.854 13.03a.75.75 0 0 1-1.06 0L3.22 8.394a.75.75 0 1 1 1.06-1.06l3.3 3.438 4.95-5.797a.733.733 0 0 1 1.05-.01z"/></svg></span>
                </button>
                <pre><code>Copyright (c) 2025 TurboAth

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software...</code></pre>
            </div>
        </section>
        
    </main>

    <script src="script.js"></script>
</body>
</html>